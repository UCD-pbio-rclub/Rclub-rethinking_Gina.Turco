---
title: "Chapter-09.Rmd"
output: 
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Do a Bayesian analysis of hypocotyl length (hyp) in the attached data sheet.

1) Consider treatment effects (trt) species effects (species) and their interaction.  What is the best model given these possible predictors?

2) Use "S. chmielewskii" as the reference.  For each of the other species evaluate the hypothesis that their response to shade differs from S. chmielewskii.

```{r}
library("rethinking")

d = read.csv("/Users/gturco/Documents/code/Rclub-rethinking_Gina.Turco/Assignment_Chapter_09/TomatoR2CSHL.csv",header=TRUE)


d$trt.h <- ifelse( d$trt=="H" , 1 , 0 )


CHS.trt <- map(
    alist(
        hyp ~ dnorm( mu , sigma ) ,
        mu <- a + bT*trt.h  ,
        a ~ dnorm( 33 , 10 ) ,
        bT ~ dnorm( 0 , 1 ) ,
        sigma ~ dunif( 0 , 10 )
) , data = d ) 

precis(CHS.trt)
plot(precis(CHS.trt))



d$species.chmiel <- ifelse( d$species=="S. chmielewskii" , 1 , 0 )
d$species.hab <- ifelse( d$species=="S. habrochaites" , 1 , 0 )
d$species.penn <- ifelse( d$species=="S. pennellii" , 1 , 0 )
d$species.per <- ifelse( d$species=="S. peruvianum" , 1 , 0 )



CHS.species <- map(
    alist(
        hyp ~ dnorm( mu , sigma ) ,
        mu <- a + bP*species.penn + bR*species.per + bH*species.hab + bC*species.chmiel  ,
        a ~ dnorm( 33 , 10 ) ,
        bP ~ dnorm( 0 , 1 ) ,
        bR ~ dnorm( 0 , 1 ) ,
        bH ~ dnorm( 0 , 1 ) ,
        bC ~ dnorm( 0 , 1 ) ,
        sigma ~ dunif( 0 , 10 )
) , data = d ) 

precis(CHS.species)
plot(precis(CHS.species))





#CHS. <- map2stan(
#    alist(
#        hyp ~ dnorm( mu , sigma ) ,
#        mu <- a + bT*trt * bS*species  + bTS*trt*species ,
#        a ~ dnorm( 10 , 10 ) ,
#        bT ~ dnorm( 0 , 1 ) ,
#        bS ~ dnorm( 0 , 1 ) ,
#        bTS ~ dnorm( 0 , 1 ) ,
#        sigma ~ dunif( 0 , 10 )
#) , data = d,iter=1e4, warmup=100 , WAIC=FALSE ) 

#plot(m.CHS)


```

